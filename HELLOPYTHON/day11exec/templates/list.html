<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
<script src="jquery-3.6.0.js"></script>

<script type="text/javascript">
	function fn_setTable(e_id, e_name, birth) {
		$("#eid").val(e_id);
		$("#ename").val(e_name);
		$("#birth").val(birth);
	}

	function fn_add() {
		var param = {
			"e_id" : $("#eid").val(),
			"e_name" : $("#ename").val(),
			"birth" : $("#birth").val()
		};
		$.ajax({
			type : 'POST',
			url : 'add.ajax',
			data : JSON.stringify(param),
			dataType : 'JSON',
			contentType : 'application/json',
			success : function(data) {
				if (data.msg == "ok") {
					location.reload();
				} else {
					alert("추가 완료");
					alret("추가 중 오류 발생");
				}
			},
			error : function(request, status, error) {
				alert('ajax 통신 실패')
				alert(error);
			}
		});
	}

	function fn_upd() {
		var param = {
			"e_id" : $("#eid").val(),
			"e_name" : $("#ename").val(),
			"birth" : $("#birth").val()
		};
		$.ajax({
			type : 'POST',
			url : 'upd.ajax',
			data : JSON.stringify(param),
			dataType : 'JSON',
			contentType : 'application/json',
			success : function(data) {
				if (data.msg == "ok") {
					alert("수정 완료");
					location.reload();
				} else {
					alret("수정 중 오류 발생")
				}
			},
			error : function(request, status, error) {
				alert('ajax 통신 실패')
				alert(error);
			}
		});
	}

	function fn_del() {
		var param = {
			"e_id" : $("#eid").val(),
		};
		$.ajax({
			type : 'POST',
			url : 'del.ajax',
			data : JSON.stringify(param),
			dataType : 'JSON',
			contentType : 'application/json',
			success : function(data) {
				if (data.msg == "ok") {
					alert("삭제 완료");
					location.reload();
				} else {
					alret("삭제 중 오류 발생")
				}
			},
			error : function(request, status, error) {
				alert('ajax 통신 실패')
				alert(error);
			}
		});
	}
</script>

</head>
<body>
	<table border="1">
		<tr>
			<td>아이디</td>
			<td>이름</td>
			<td>생년월일</td>
		</tr>
		{% for emp in mylist %}
		<tr>
			<td><a
				href="javascript:fn_setTable('{{emp.e_id}}','{{emp.e_name}}','{{emp.birth}}')">{{emp.e_id}}</a></td>
			<td>{{emp.e_name}}</td>
			<td>{{emp.birth}}</td>
		</tr>
		{% endfor %}
	</table>

	<table border="1">
		<tr>
			<td>아이디</td>
			<td><input type="text" name="eid" id="eid"></td>
		</tr>
		<tr>

			<td>이름</td>
			<td><input type="text" name="ename" id="ename"></td>
		</tr>
		<tr>
			<td>생년월일</td>
			<td><input type="text" name="birth" id="birth"></td>
		</tr>
		<tr>
			<td colspan="2">
				<button type="button" onclick="fn_add()">추가</button>
				<button type="button" onclick="fn_upd()">수정</button>
				<button type="button" onclick="fn_del()">삭제</button>
			</td>
		</tr>
	</table>
</body>
</html>